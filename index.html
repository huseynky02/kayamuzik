<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>MHÖAL - 10 Kasım</title>
    <style>
        :root{
            --bg-1: #0f1724;
            --bg-2: #0b1220;
            --card: #0b1220;
            --accent-1: #7c5cff;
            --accent-2: #2bd4f7;
            --muted: #9aa6b2;
            --glass: #0b1220;
        }

        /* Keep splash but simple */
        #splash{
            position:fixed;
            inset:0;
            display:flex;
            align-items:center;
            justify-content:center;
            background:#000;
            color:#fff;
            z-index:9999;
            -webkit-font-smoothing:antialiased;
            transition: opacity .3s ease;
        }
        #splash.hidden{ opacity:0; pointer-events:none; }
        .splash-inner{ text-align:center; }
        .splash-title{
            font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, "Helvetica Neue", Arial;
            font-size:28px;
            letter-spacing:1.5px;
            font-weight:700;
            color:#fff;
            text-transform:uppercase;
        }
        .splash-sub{ margin-top:6px; color:#cfcfcf; font-size:12px; }

        /* remove decorative background artwork */
        .bg-art{ display:none !important; }

        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%}
        body{
            font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, "Helvetica Neue", Arial;
            background: var(--bg-2); /* solid dark background */
            color: #e6eef8;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            padding:20px;
            display:flex;
            justify-content:center;
            align-items:flex-start;
            gap:20px;
            min-height:100vh;
        }

        .app {
            width:100%;
            max-width:900px;
            margin: 24px auto;
            position:relative;
        }

        header {
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:16px;
            margin-bottom:18px;
        }

        header h1{
            font-size:1.25rem;
            color: #f5f8ff;
            letter-spacing:0.2px;
            display:block;
            width:100%;
            margin:0 auto;
            text-align:center;
        }

        /* Playlist card: remove translucency and heavy shadows */
        .playlist-wrap{
            background: var(--card);
            border: 1px solid #0b0b0b;
            border-radius:8px;
            padding:14px;
            max-height:72vh;
            overflow:auto;
        }

        .playlist-item{
            display:flex;
            gap:12px;
            align-items:center;
            padding:10px;
            border-radius:8px;
            transition: background .12s ease, transform .12s ease;
            cursor:pointer;
            background: transparent;
            border: 1px solid transparent;
        }

        .playlist-item + .playlist-item{ margin-top:8px }

        .playlist-item:hover{
            transform: translateY(-2px);
            background: #0d1520;
            border-color: rgba(255,255,255,0.02);
        }

        .playlist-item.active{
            background: #111827;
            border-color: rgba(255,255,255,0.03);
            transform: translateY(-2px);
        }

        .item-thumb{
            width:48px;height:48px;border-radius:8px;
            background: var(--accent-1);
            display:flex;align-items:center;justify-content:center;
            font-weight:600;color:#fff;
            flex:0 0 48px;
        }

        .item-meta{
            flex:1;
            min-width:0;
        }

        .item-title{
            font-size:1rem;
            color:#eaf3ff;
            white-space:nowrap;
            overflow:hidden;text-overflow:ellipsis;
        }

        .item-sub{
            font-size:0.85rem;color:var(--muted);margin-top:4px;
        }

        .loading, .error{ padding:12px;border-radius:8px;text-align:center; margin-bottom:10px;}
        .loading{ color:var(--accent-2); background: transparent; border:1px solid rgba(43,212,247,0.04)}
        .error{ color:#ffb4b4; background: transparent; border:1px solid rgba(255,80,80,0.04)}

        /* Bottom player (initially hidden) - simplified */
        #playerBar {
            position: fixed;
            left: 16px;
            right: 16px;
            bottom: 16px;
            border-radius:10px;
            background: var(--card);
            border:1px solid #0b0b0b;
            padding:10px 12px;
            display:flex;
            gap:10px;
            align-items:center;
            transform: translateY(120%);
            transition: transform .35s ease;
            z-index:50;
            max-width:calc(100% - 32px);
        }

        #playerBar.show{ transform: translateY(0); }

        .player-info{
            display:flex;
            gap:10px;
            align-items:center;
            min-width:0;
            flex: 1 1 65%;
        }

        .player-thumb{
            width:56px;height:56px;border-radius:8px;
            background: var(--accent-1);
            display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;
            flex:0 0 56px;
        }

        .player-details{
            min-width:0;
            flex: 1 1 auto;
            display:flex;
            flex-direction:column;
            gap:6px;
        }

        .player-title{ font-weight:700; font-size:1rem; color:#f7fbff; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
        .player-sub{ color:var(--muted); font-size:0.85rem; margin-top:4px }

        .player-controls{
            /* simpler centered controls: only play + volume */
            display:flex;
            flex-direction:column;
            gap:10px;
            align-items:center;
            justify-content:center;
            flex: 0 0 auto;
            max-width:220px;
        }

        .controls-top{
            display:flex;
            gap:8px;
            align-items:center;
        }

        .btn{
            background: #0d1620;
            border:1px solid #0b0b0b;
            color:#eaf3ff;
            padding:8px;
            border-radius:8px;
            cursor:pointer;
            transition: transform .08s ease;
            min-width:40px;
            display:inline-flex;
            align-items:center;justify-content:center;
        }
        .btn:hover{ transform:translateY(-2px); }

        .play-btn{ width:48px; height:48px; font-size:16px; border-radius:8px; background: var(--accent-1); color:#fff; font-weight:700 }

        .progress-wrap{
            width:100%;
            margin-top:6px;
            display:block;
        }
        .progress-bar{
            height:8px;background:#0b0b0b; border-radius:999px; overflow:hidden; cursor:pointer;
        }
        .progress{ height:100%; width:0%; background: var(--accent-1); transition: width .08s linear; }

        .time-row{ display:flex; justify-content:space-between; font-size:12px; color:var(--muted); margin-top:6px }

        /* Volume slider simplified */
        .volume-slider{
            width:120px;
            height:6px;
            border-radius:999px;
            background: #0b0b0b;
            outline:none;
            -webkit-appearance:none;
            -moz-appearance:none;
            appearance:none;
        }
        .volume-slider::-webkit-slider-thumb{
            -webkit-appearance:none;
            width:14px;height:14px;border-radius:50%; background:var(--accent-1); border:none; cursor:pointer;
        }
        .volume-slider::-moz-range-thumb{
            -moz-appearance:none;
            appearance:none;
            width:14px;height:14px;border-radius:50%; background:var(--accent-1); border:none; cursor:pointer;
        }

        /* Responsive */
        @media (max-width:720px){
            .player-thumb{ width:48px;height:48px; flex:0 0 48px }
            .player-info{ gap:8px }
            .btn{ padding:6px; min-width:36px }
            .volume-slider{ width:90px }
            .seek-input{ width:120px }
            .player-controls{ flex: 0 0 220px; max-width:40%; }
            .player-info{ flex: 1 1 60%; }
            #playerBar{ left:12px; right:12px; bottom:12px; padding:8px }
        }

        @media (max-width:420px){
            .player-controls{ flex-direction:row; align-items:center }
            .player-details{ display:none }
            .player-controls{ flex: 0 0 auto; max-width:100%; }
        }
    </style>
</head>
<body>
 
<!-- decorative transparent background art -->
<div class="bg-art" aria-hidden="true"></div>
 
<!-- Fullscreen black&white splash shown on first load -->
<div id="splash" role="status" aria-live="polite">
    <div class="splash-inner">
    </div>
</div>
 
<div class="app">
    <header>
        <h1>10 Kasım Müzik Listesi</h1>
    </header>
    
    <div id="loadingMessage" class="loading">Şarkılar yükleniyor...</div>
    <div id="errorMessage" class="error" style="display:none"></div>
    
    <div class="playlist-wrap" id="playlistWrap" aria-live="polite">
        <div id="playlist" role="list"></div>
    </div>
</div>
 
<!-- Bottom player appears when a track is selected -->
<div id="playerBar" aria-hidden="true">
    <div class="player-info">
        <div class="player-thumb" id="playerThumb">♪</div>
        <div class="player-details">
            <div class="player-title" id="playerTitle">—</div>
            <div class="player-sub" id="playerSub">Çalma listesi</div>
 
            <div class="progress-wrap">
                <div class="progress-bar" id="progressBar">
                    <div class="progress" id="progress"></div>
                </div>
                <div class="time-row">
                    <div id="currentTime">0:00</div>
                    <div id="duration">0:00</div>
                </div>
            </div>
        </div>
    </div>
 
    <div class="player-controls" style="min-width:220px;">
        <!-- Centered play/pause -->
        <button class="play-btn" id="playBtn" onclick="togglePlay()">▶</button>
 
        <!-- compact row with time + volume -->
        <div style="display:flex;align-items:center;gap:10px;">
            <div style="font-size:12px;color:var(--muted);min-width:48px;text-align:center;" id="playerSmallTime">0:00</div>
            <input id="volumeSlider" class="volume-slider" type="range" min="0" max="100" value="70" aria-label="Ses"/>
        </div>
    </div>
    <script>
        // update small time display from existing timeupdate listener
        audioPlayer.addEventListener('timeupdate', ()=> {
            const sm = document.getElementById('playerSmallTime');
            if (sm) sm.textContent = formatTime(audioPlayer.currentTime);
        });
    </script>
</div>
 
<script>
    // GitHub Pages friendly manifest location
    const PLAYLIST_MANIFEST = 'music/playlist.json';
   const splash = document.getElementById('splash');
   const splashStartedAt = Date.now(); // kayıt: splash gösterilmeye başlandığı an
 
   // gizleme: minimum süre (ms) için 3000 = 3s
   const SPLASH_MIN_MS = 3000;
   function hideSplash() {
       if (!splash) return;
       const elapsed = Date.now() - splashStartedAt;
       const wait = Math.max(0, SPLASH_MIN_MS - elapsed);
       // beklemesi bitince gizle ve ardından DOM'dan kaldır
       setTimeout(()=> {
           splash.classList.add('hidden');
           setTimeout(()=> { if (splash && splash.parentNode) splash.parentNode.removeChild(splash); }, 600);
       }, wait);
    }
 
    let audioPlayer = new Audio();
    let playlist = [];
    let currentSongIndex = -1;
    let isPlaying = false;
 
    const loadingMsg = document.getElementById('loadingMessage');
    const errorMsg = document.getElementById('errorMessage');
    const playlistDiv = document.getElementById('playlist');
    const playerBar = document.getElementById('playerBar');
 
    window.addEventListener('load', loadMusicFiles);
 
    async function loadMusicFiles(){
        try{
            // keep splash visible until playlist rendered; show the small loading text too
            loadingMsg.style.display = 'none';
            const resp = await fetch(PLAYLIST_MANIFEST, { cache: 'no-cache' });
            if(!resp.ok) throw new Error('Playlist manifesti bulunamadı: ' + PLAYLIST_MANIFEST);
            const files = await resp.json();
 
            if(!Array.isArray(files) || files.length === 0) throw new Error('Playlist boş. music/playlist.json içine MP3 dosya adlarını ekleyin.');
 
            const validFiles = [];
            for(const entry of files){
                let fileName = null;
                let displayName = null;
 
                // manifest entry can be a string (filename) or an object { "file": "x.mp3", "title": "Görünen Ad" }
                if(typeof entry === 'string'){
                    fileName = entry;
                    displayName = entry.replace(/\.[^/.]+$/, "");
                } else if (entry && typeof entry === 'object'){
                    // accept several keys for compatibility
                    fileName = entry.file || entry.path || entry.src || entry.filename;
                    displayName = entry.title || entry.name || null;
                }
 
                if(!fileName || typeof fileName !== 'string') continue;
 
                // make a usable URL: allow absolute URLs or paths that already include "music/"
                let filePath = fileName.trim();
                if(!/^https?:\/\//i.test(filePath) && !filePath.startsWith('/')) {
                    // if user provided only a filename, prepend music/
                    if(!filePath.startsWith('music/')) filePath = `music/${filePath}`;
                }
 
                if(!displayName) displayName = fileName.replace(/^.*[\\/]/, '').replace(/\.[^/.]+$/, "");
 
                try{
                    const head = await fetch(filePath, { method: 'HEAD' });
                    if(head.ok){
                        validFiles.push({ url: filePath, name: displayName, file: fileName });
                    } else {
                        console.warn('Dosya bulunamadı (HEAD):', filePath);
                    }
                }catch(e){
                    // bazı sunucular HEAD'a izin vermez; yine de ekleyelim
                    console.warn('HEAD isteği hata, ekleniyor:', filePath);
                    validFiles.push({ url: filePath, name: displayName, file: fileName });
                }
            }
 
            if(validFiles.length === 0) throw new Error('Hiç şarkı dosyası doğrulanamadı. "music" klasörüne MP3 dosyaları ekleyin ve music/playlist.json dosyasını güncelleyin.');
 
            playlist = validFiles;
            renderPlaylist();
            // hide splash after playlist rendered so user sees transition to UI
            hideSplash();
        }catch(err){
            loadingMsg.style.display = 'none';
            errorMsg.style.display = 'block';
            errorMsg.textContent = err.message || String(err);
            // still hide splash so errors are visible
            hideSplash();
        }
    }
 
    function renderPlaylist(){
        playlistDiv.innerHTML = '';
        playlist.forEach((song, idx) => {
            const it = document.createElement('div');
            it.className = 'playlist-item';
            it.setAttribute('role','button');
            it.innerHTML = `
                <div class="item-thumb">${String(idx+1)}</div>
                <div class="item-meta">
                    <div class="item-title">${escapeHtml(song.name)}</div>
                    <div class="item-sub">${song.file}</div>
                </div>
            `;
            it.onclick = () => selectSong(idx);
            playlistDiv.appendChild(it);
        });
    }
 
    function selectSong(index){
        currentSongIndex = index;
        loadSong(index);
        // show bottom player with transition
        playerBar.classList.add('show');
        playerBar.setAttribute('aria-hidden','false');
        // highlight active
        document.querySelectorAll('.playlist-item').forEach((el,i)=>{
            el.classList.toggle('active', i === index);
        });
        // scroll player into view on small screens
        if(window.innerWidth < 720) playerBar.scrollIntoView({behavior:'smooth', block:'end'});
    }
 
    function loadSong(index){
        const song = playlist[index];
        if(!song) return;
        audioPlayer.src = song.url;
        audioPlayer.currentTime = 0;
        document.getElementById('playerTitle').textContent = song.name;
        document.getElementById('playerSub').textContent = song.file;
        document.getElementById('playerThumb').textContent = song.name.charAt(0).toUpperCase() || '♪';
        updatePlayButton(false);
        // auto-play
        setTimeout(()=> { // small delay to allow metadata load
            audioPlayer.play().then(()=> { isPlaying = true; updatePlayButton(true) }).catch(()=>{});
        }, 120);
    }
 
    function togglePlay(){
        if(audioPlayer.paused){
            audioPlayer.play();
            isPlaying = true;
            updatePlayButton(true);
        } else {
            audioPlayer.pause();
            isPlaying = false;
            updatePlayButton(false);
        }
    }
 
    function updatePlayButton(playing){
        const b = document.getElementById('playBtn');
        b.textContent = playing ? '⏸' : '▶';
    }
 
    // previous/next controls removed intentionally
    // second-based jump/step functions removed intentionally
 
    // progress / time updates
    audioPlayer.addEventListener('timeupdate', ()=> {
        const p = (audioPlayer.currentTime / (audioPlayer.duration || 1)) * 100 || 0;
        document.getElementById('progress').style.width = p + '%';
        document.getElementById('currentTime').textContent = formatTime(audioPlayer.currentTime);
    });
 
    audioPlayer.addEventListener('loadedmetadata', ()=> {
        document.getElementById('duration').textContent = formatTime(audioPlayer.duration);
    });
 
    // on ended: stop and reset to start (no auto-next)
    audioPlayer.addEventListener('ended', ()=> {
        isPlaying = false;
        updatePlayButton(false);
        audioPlayer.currentTime = 0;
    });
 
    // click to seek on progress bar
    document.getElementById('progressBar').addEventListener('click', function(e){
        const rect = this.getBoundingClientRect();
        const percent = (e.clientX - rect.left) / rect.width;
        audioPlayer.currentTime = percent * (audioPlayer.duration || 0);
    });
 
    // volume
    const volumeSlider = document.getElementById('volumeSlider');
    volumeSlider.addEventListener('input', (e)=> {
        audioPlayer.volume = e.target.value / 100;
    });
    audioPlayer.volume = volumeSlider.value / 100;
 
    // utilities
    function formatTime(sec){
        if(!sec || isNaN(sec)) return '0:00';
        const m = Math.floor(sec/60);
        const s = Math.floor(sec%60);
        return m + ':' + (s < 10 ? '0' : '') + s;
    }
 
    function escapeHtml(s){
        return String(s)
            .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
    }
 
    // Allow keyboard control for accessibility
    window.addEventListener('keydown', (e)=>{
        if(!playerBar.classList.contains('show')) return;
        if(e.code === 'Space'){ e.preventDefault(); togglePlay(); }
        // Arrow keys no longer change position
     });
</script>
</body>
</html>
